/*!
 * ZUI - v1.2.1 - 2015-04-17
 * http://zui.sexy
 * GitHub: https://github.com/easysoft/zui.git 
 * Copyright (c) 2015 cnezsoft.com; Licensed MIT
 */

!function(a,b){"use strict";String.prototype.endsWith||(String.prototype.endsWith=function(a,b){var c=this.toString();(void 0===b||b>c.length)&&(b=c.length),b-=a.length;var d=c.indexOf(a,b);return-1!==d&&d===b}),String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return b=b||0,this.lastIndexOf(a,b)===b}),String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)});var c=!1,d=1;d&&console.error("DEBUG ENABLED.");var e={learn:{col:1},start:{col:1},basic:{col:1},control:{col:2},component:{col:2},javascript:{col:3},view:{col:3}},f="lastReloadAnimate",g="LAST_QUERY_ID",h="index.json",i=void 0,j={"index.json":null};d&&(a.dataset=j);var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=-1,B=1120,C=function(){if(!(document.body.clientWidth>=a.innerWidth)){if(0>A){var b=document.createElement("div");b.className="modal-scrollbar-measure",k.append(b),A=b.offsetWidth-b.clientWidth,k[0].removeChild(b)}if(A){var c=parseInt(k.css("padding-right")||0,10);k.css("padding-right",c+A)}}},D=function(){k.css("padding-right","")},E=function(a,e,f){var g=j[a],h=g===i||null===g;if(h?(g=b.store.get(a,null),console.log(a,g),j[a]=g,null!==g&&(d&&console.log("Load data from storage: ",a,", size:",g.length),e(g))):null!==g&&(d&&console.log("Load data from cache: ",a,", size:",g.length),e(g)),h||null===g||f||h||!c){var k=a.endsWith(".json")?"json":"html";b.get(a,function(c){if(!d&&null!==g){if("json"===k&&b.isPlainObject(c)&&g.version&&c.version&&c.version===g.version)return;if("html"===k&&g===c)return}j[a]=c,d&&console.log("Load data from remote: ",a,", size:",c.length),e(c),b.store.set(a,c)},k)}},F=function(a,c){var d=j[h];return d?(b.each(e,function(e,f){if(d.chapters[e]){b.extend(f,d.chapters[e]);var g=f.sections,h=null;return c&&(h=c(f,g),h===!1)?!1:void b.each(g,function(b,c){return a(f,c,h)===!1?!1:void 0})}}),!0):(console.error("Document index is empty."),!1)},G=function(a,b){a.attr("class","icon").text(""),(void 0===b.icon||null===b.icon||""===b.icon)&&(b.icon=b.name.substr(0,1).toUpperCase()),0===b.icon.indexOf("icon-")?a.addClass(b.icon):a.addClass("text-icon").text(b.icon)},H=function(){var a=0;F(function(b,c,d){var e=b.id;c.chapter=e;var f=n.clone().attr("id","section-"+e+"-"+c.id).data("section",c);f.attr("data-id",c.id).attr("data-chapter",e).attr("data-order",a++);var g=f.children(".card-heading");g.find(".name").text(c.name),g.children(".desc").text(c.desc),G(g.children(".icon"),c);var h=f.find(".topics");if(c.topics&&c.topics.length)for(var i in c.topics){var j=c.topics[i];j.id=i,h.append('<li data-id="'+i+'">'+j.name+"</li>")}else h.remove(".card-content"),f.addClass("without-topics");d.append(f.addClass("show"))},function(a,b){var c=a.$sections;return c.children().remove(),c})?(k.children(".loader").removeClass("loading"),clearTimeout(m.data(f)),m.data(f,setTimeout(function(){y=m.find(".section").addClass("in"),z.addClass("in")},100))):d&&console.error("Display sections failed.")},I=function(a,b,c){a===i&&(a=k),b===i||"down"===b?b=a.scrollTop()+.8*(l.height()-a.offset().top):"up"===b&&(b=a.scrollTop()-.8*(l.height()-a.offset().top)),a.animate({scrollTop:b},200,"swing",c)},J=function(a){if(a){a.offset().top,a.outerHeight(),l.height(),k.scrollTop()}},K=function(a){return a===i&&(a=r),a&&a.hasClass("choosed")&&a.hasClass("show")},L=function(a,b,c){if(y){if(K(a||null)&&!c)return r=a.addClass("open"),void J(a);var d=a&&a.hasClass("open");y.removeClass(b?"choosed":"choosed open"),a&&a.hasClass("section")&&(r=a.addClass(c&&!d?"choosed":"choosed open"),J(a))}},M=function(){var a=y.filter(".show");if(K()){for(var b=parseInt(r.data("order")),c=r;--b>-1;){var d=a.filter('[data-order="'+b+'"]');if(d.length){c=d;break}}L(c)}else L(a.first())},N=function(){var a=y.filter(".show");if(K()){for(var b=parseInt(r.data("order")),c=r,d=y.length;b++<d;){var e=a.filter('[data-order="'+b+'"]');if(e.length){c=e;break}}L(c)}else L(a.first())},O=function(a,b,c,d){return Math.sqrt(Math.pow(a-c,2)+Math.pow(b-d,2),2)},P=function(){var a=y.filter(".show");if(K()){var c=r.offset(),d=c.left-m.children(".container").offset().left-10;if(50>d)return void M();var e=c.top;d=c.left;var f=r,g=99999;a.each(function(){var a=b(this),c=a.offset();if(c.left+50<d){var h=O(c.left,c.top,d,e);g>h&&(f=a,g=h)}}),L(f)}else L(a.first())},Q=function(){var a=y.filter(".show");if(K()){var c=r.offset(),d=m.children(".container"),e=c.left-d.offset().left-10;if(e+20+r.outerWidth()+50>=d.outerWidth())return void N();var f=c.top;e=c.left;var g=r,h=99999;a.each(function(){var a=b(this),c=a.offset();if(c.left>e){var d=O(c.left,c.top,e,f);h>d&&(g=a,h=d)}}),L(g)}else L(a.first())},R=function(){q.removeClass("hide"),p.removeClass("hide"),y.addClass("show"),z.addClass("show"),m.data(f,setTimeout(function(){y.addClass("in"),z.addClass("in")},20)),k.removeClass("query-enabled")},S=function(a){if(y){if(o.data("queryString")!==a&&(o.data("queryString",a).val(a),m.css("min-height",m.height())),a===i||null===a||!a.length)return void R();k.addClass("query-enabled");var c=[];if(b.each(a.split(" "),function(a,d){d=b.trim(d).toLowerCase();var f={origin:d};d.startsWith("#")?(f.type="id",f.val=d.substr(1)):d.startsWith("icon-")||d.startsWith("icon:")?(f.type="icon",f.val=d.substr(5)):d.startsWith("i:")?(f.type="icon",f.val=d.substr(1)):d.startsWith("ver:")?(f.type="version",f.val=d.substr(4)):d.startsWith("v:")?(f.type="version",f.val=d.substr(2)):d.startsWith("version:")?(f.type="version",f.val=d.substr(8)):d.startsWith("grunt:")||d.startsWith("build:")?(f.type="build",f.val=d.substr(6)):d.startsWith("g:")||d.startsWith("b:")?(f.type="build",f.val=d.substr(2)):(b.each(e,function(a){return d.startsWith(a+":")?(f.type="id",f.chapter=a,f.val=d.substr(a.length),!1):void 0}),f.type||(f.type="any",f.val=d)),f.val.length&&c.push(f)}),!c.length)return void R();var f,g,h,j,n,p,r,s={},t={};if(F(function(a,d){h=!0,p=[],f=0,b.each(c,function(c,e){switch(n=e.val,r=null,j=!1,e.type){case"id":j=(e.chapter?a:d).id.includes(n),j&&(r=[e.chapter?"chapter":"section","id"]),f=100;break;case"icon":j="icons"===d.id,j&&(r=["section","id"]),f=100;break;default:if(d.name.toLowerCase().includes(n)){j=!0,r=["section","name"],f=80;break}if(a.name.toLowerCase().includes(n)){j=!0,r=["chapter","name"],f=70;break}if(n.length>1){if(d.id.includes(n)){j=!0,r=["section","id"],f=65;break}if(a.id.includes(n)){j=!0,r=["chapter","id"],f=60;break}if(b.isArray(d.topics)){var g=!1;if(b.each(d.topics,function(a,b){return b.name&&b.name.toLowerCase().includes(n)?(j=!0,r=["section","topic",a],g=!0,f=20,!1):void 0}),g)break}if(d.desc.toLowerCase().includes(n)){j=!0,r="section.desc",f=30;break}}else{if(a.id.startsWith(n)){j=!0,r=["chapter","id"],f=60;break}if(d.id.startsWith(n)){j=!0,r=["section","id"],f=50;break}}}return j?void p.push({key:e,type:r}):(h=!1,!1)}),g=a.id+"-"+d.id,h?(t[a.id]++,s[g]={hidden:!1,matches:p,weight:f}):s[g]={hidden:!0}},function(a){t[a.id]=0})){var u,v,w=b(),z=b(),A=-1;b.each(s,function(a,c){u=b("#section-"+a),c.hidden?w=w.add(u):(z=z.add(u),A<c.weight&&(v=u,A=c.weight)),L(v)});var B,C;b.each(t,function(a,b){C=e[a],B=!b,C.$.toggleClass("hide",B)});var D,E=0;q.each(function(){D=b(this);var a=D.children(".chapter:not(.hide)").length;if(D.toggleClass("hide",!a),a&&(E++,!k.hasClass("compact-mode"))){var c=D.find(".section:not(.hide)").length;c>2&&l.height()<x.height()+70*c&&(k.addClass("compact-mode"),setTimeout(function(){l.scrollTop(1),k.addClass("compact-mode-in")},10))}}),m.attr("data-show-col",E),w.length&&(w.removeClass("in"),setTimeout(function(){w.removeClass("show")},100)),z.length&&(z.addClass("show"),setTimeout(function(){z.addClass("in")},20)),l.scrollTop(1),U()}else d&&console.error("Query failed with key: ",c)}},T=function(a,b){a===i&&(a=!k.hasClass("compact-mode"));var c="isScrollAnimating";a?k.hasClass("compact-mode")?b&&b():(k.data(c,!0).addClass("compact-mode"),setTimeout(function(){k.addClass("compact-mode-in"),l.scrollTop(1),setTimeout(function(){k.data(c,!1),b&&b()},500)},10)):k.hasClass("compact-mode")?(k.data(c,!0).removeClass("compact-mode-in"),setTimeout(function(){k.removeClass("compact-mode"),k.data(c,!1),b&&b()},500)):b&&b()},U=function(){if(k.hasClass("page-show")){var a=s.data("trans-style");return a["max-height"]="",s.css(a),k.removeClass("page-show-in"),setTimeout(function(){k.removeClass("page-show"),D()},300),!0}return!1},V=function(a,b,c){L(a,!1,!0),U(),k.attr("data-page-chapter",b.chapter),G(t.children(".icon"),b),t.find(".name").text(b.name),t.children(".desc").text(b.desc),u.html(""),s.addClass("loading"),E(b.url,function(a){s.removeClass("loading"),u.html(a),o.blur(),w.scrollTop(0)}),T(!0,function(){var b=a.offset(),c=a.outerHeight(),d={left:b.left-m.children(".container").offset().left-6,top:b.top-l.scrollTop()-80,width:a.outerWidth(),height:c,"max-height":c};s.css(d).data("trans-style",d),w.css("width",B),C(),k.addClass("page-show"),setTimeout(function(){k.addClass("page-show-in"),w.scrollTop(0),setTimeout(function(){B=w.css("width","").width()+40},310)},10)})},W=function(c,e){c=c||r;var f;if(b.isPlainObject(c))f=b("#section-"+c.chapter+"-"+c.id);else{var g=c;c=g.data("section"),f=g}var h=c.url;return null===h?void(d&&console.error("Open section stop by null url.")):(h||(h="part/"+c.chapter+"-"+c.id+".html",c.url=h),h=h.toLowerCase(),void(h.startsWith("http://")||h.startsWith("https://")?a.open(h,"_blank"):V(f,c,e)))},X=function(){k.hasClass("page-show-in")&&!s.hasClass("loading")&&s.css("height",Math.min(v.outerHeight(),t.outerHeight()+u.outerHeight()+50))};b(function(){var c=function(a){a.stopPropagation()};l=b(a),k=b("body"),m=b("#grid"),x=b("#header"),q=m.find(".col"),s=b("#page"),t=b("#pageHeader"),v=b("#pageContainer"),u=b("#pageContent"),p=m.find(".chapter"),o=b("#searchInput"),z=m.find(".chapter-heading"),n=b("#sectionTemplate").attr("id",null),w=b("#pageBody"),b.each(e,function(a,c){a=a.toLowerCase(),c.$=b("#chapter-"+a),c.id=a,c.$sections=b("#sections-"+a)}),B=m.children(".container").outerWidth(),E(h,H),b(document).on("click",function(a){return k.hasClass("page-show")?void U():(L(),void y.removeClass("open"))}),s.on("click",c),m.on("click",".card-heading",function(a){var d=b(this).closest(".card");d.hasClass("choosed")?d.toggleClass("open"):L(d,!0),c(a)}).on("click",".card",function(a){L(b(this),!0),c(a)}).on("click",".card-heading > h5 > .name, .card-heading > .icon",function(a){W(b(this).closest(".section")),c(a)}).on("click",".topics > li",function(a){var d=b(this);W(d.closest(".section"),d.data("id")),c(a)}).on("mouseenter",".card-heading > h5 > .name, .card-heading > .icon",function(){b(this).closest(".card-heading").addClass("hover")}).on("mouseleave",".card-heading > h5 > .name, .card-heading > .icon",function(){b(this).closest(".card-heading").removeClass("hover")}),u.on("resize",X),l.resize(X),t.on("click",".path-close-btn",function(){U()});var d,f=b("#navbar").outerHeight();l.on("scroll",function(a){var b=k.data("isScrollAnimating");return b?void l.scrollTop(1):(d=l.scrollTop(),void(d>f&&!k.hasClass("compact-mode")?T(!0):k.hasClass("compact-mode")&&(1>d?T(!1):x.toggleClass("with-shadow",d>20))))}).on("keydown",function(a){var b=a.which;console.log("keydown",b);var c=!k.hasClass("page-show");13===b?c&&K()&&W():27===b?U()||k.hasClass("input-query-focus")&&S():32===b?(U()||(k.hasClass("compact-mode")?K()&&W():T(!0)),a.preventDefault()):37===b?(P(),a.preventDefault()):39===b?(Q(),a.preventDefault()):38===b?c?M():I(w,"up"):40===b&&(c?N():I(w),a.preventDefault())}),w.on("scroll",function(a){s.toggleClass("with-shadow",w.scrollTop()>20)}),o.on("change keyup paste input propertychange",function(){var a=o.val();a!==o.data("queryString")&&(clearTimeout(o.data(g)),o.data(g,setTimeout(function(){S(a)},150)))}).on("focus",function(){k.addClass("input-query-focus"),o.val()&&!y.filter(".open").length&&L(y.filter(".show:first"))}).on("blur",function(){k.removeClass("input-query-focus")}).on("click",c),b('[data-toggle="tooltip"]').tooltip({container:"body"})})}(window,jQuery);