/*!
 * ZUI - v1.3.0 - 2015-04-18
 * http://zui.sexy
 * GitHub: https://github.com/easysoft/zui.git 
 * Copyright (c) 2015 cnezsoft.com; Licensed MIT
 */

!function(a,b){"use strict";String.prototype.endsWith||(String.prototype.endsWith=function(a,b){var c=this.toString();(void 0===b||b>c.length)&&(b=c.length),b-=a.length;var d=c.indexOf(a,b);return-1!==d&&d===b}),String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return b=b||0,this.lastIndexOf(a,b)===b}),String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)});var c=!1,d=1;d&&console.error("DEBUG ENABLED.");var e={learn:{col:1},start:{col:1},basic:{col:1},control:{col:2},component:{col:2},javascript:{col:3},view:{col:3}},f="lastReloadAnimate",g="LAST_QUERY_ID",h="index.json",i=void 0,j="page-show-full",k={};d&&(a.dataset=k);var l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=-1,D=1120,E=function(){if(!(document.body.clientWidth>=a.innerWidth)){if(0>C){var b=document.createElement("div");b.className="modal-scrollbar-measure",l.append(b),C=b.offsetWidth-b.clientWidth,l[0].removeChild(b)}if(console.log("checkScrollbar",C),C){var c=parseInt(l.css("padding-right")||0,10);l.css("padding-right",c+C),y.css("padding-right",C)}}},F=function(){l.css("padding-right",""),y.css("padding-right","")},G=function(a,e,f){var g=k[a],h=g===i||null===g;if(h?(g=b.store.get(a,null),k[a]=g,null!==g&&(d&&console.log("Load data from storage: ",a,", size:",g.length),e(g))):null!==g&&(d&&console.log("Load data from cache: ",a,", size:",g.length),e(g)),h||null===g||f||h||!c){var j=a.endsWith(".json")?"json":"html";b.get(a,function(c){if(!d&&null!==g){if("json"===j&&b.isPlainObject(c)&&g.version&&c.version&&c.version===g.version)return;if("html"===j&&g===c)return}k[a]=c,d&&console.log("Load data from remote: ",a,", size:",c.length),e(c),b.store.set(a,c)},j)}},H=function(a,c){var d=k[h];return d?(b.each(e,function(e,f){if(d.chapters[e]){b.extend(f,d.chapters[e]);var g=f.sections,h=null;return c&&(h=c(f,g),h===!1)?!1:void b.each(g,function(b,c){return a(f,c,h)===!1?!1:void 0})}}),!0):(console.error("Document index is empty."),!1)},I=function(a,b){a.attr("class","icon").text(""),(void 0===b.icon||null===b.icon||""===b.icon)&&(b.icon=b.name.substr(0,1).toUpperCase()),0===b.icon.indexOf("icon-")?a.addClass(b.icon):a.addClass("text-icon").text(b.icon)},J=function(){var a=0;H(function(b,c,d){var e=b.id;c.chapter=e;var f=e+"-"+c.id,g=o.clone().attr("id","section-"+f).data("section",c);g.attr("data-id",c.id).attr("data-chapter",e).attr("data-order",a++);var h=g.children(".card-heading");h.find(".name").text(c.name).attr("href","#"+f),h.children(".desc").text(c.desc),I(h.children(".icon"),c);var i=g.find(".topics");if(c.topics&&c.topics.length)for(var j in c.topics){var k=c.topics[j];k.id=j,i.append('<li data-id="'+j+'">'+k.name+"</li>")}else i.remove(".card-content"),g.addClass("without-topics");d.append(g.addClass("show"))},function(a,b){var c=a.$sections;return c.children().remove(),c})?(l.children(".loader").removeClass("loading"),clearTimeout(n.data(f)),n.data(f,setTimeout(function(){A=n.find(".section").addClass("in"),B.addClass("in")},100))):d&&console.error("Display sections failed.")},K=function(a,b,c){a===i&&(a=l),b===i||"down"===b?b=a.scrollTop()+.8*(m.height()-a.offset().top):"up"===b&&(b=a.scrollTop()-.8*(m.height()-a.offset().top)),a.animate({scrollTop:b},200,"swing",c)},L=function(a){if(a){a.offset().top,a.outerHeight(),m.height(),l.scrollTop()}},M=function(a){return a===i&&(a=s),a&&a.hasClass("choosed")&&a.hasClass("show")},N=function(a,b,c){if(A){if(M(a||null)&&!c)return s=a.addClass("open"),void L(a);var d=a&&a.hasClass("open");A.removeClass(b?"choosed":"choosed open"),a&&a.hasClass("section")&&(s=a.addClass(c&&!d?"choosed":"choosed open"),L(a))}},O=function(){var a=A.filter(".show");if(M()){for(var b=parseInt(s.data("order")),c=s;--b>-1;){var d=a.filter('[data-order="'+b+'"]');if(d.length){c=d;break}}N(c)}else N(a.first())},P=function(){var a=A.filter(".show");if(M()){for(var b=parseInt(s.data("order")),c=s,d=A.length;b++<d;){var e=a.filter('[data-order="'+b+'"]');if(e.length){c=e;break}}N(c)}else N(a.first())},Q=function(a,b,c,d){return Math.sqrt(Math.pow(a-c,2)+Math.pow(b-d,2),2)},R=function(){var a=A.filter(".show");if(M()){var c=s.offset(),d=c.left-n.children(".container").offset().left-10;if(50>d)return void O();var e=c.top;d=c.left;var f=s,g=99999;a.each(function(){var a=b(this),c=a.offset();if(c.left+50<d){var h=Q(c.left,c.top,d,e);g>h&&(f=a,g=h)}}),N(f)}else N(a.first())},S=function(){var a=A.filter(".show");if(M()){var c=s.offset(),d=n.children(".container"),e=c.left-d.offset().left-10;if(e+20+s.outerWidth()+50>=d.outerWidth())return void P();var f=c.top;e=c.left;var g=s,h=99999;a.each(function(){var a=b(this),c=a.offset();if(c.left>e){var d=Q(c.left,c.top,e,f);h>d&&(g=a,h=d)}}),N(g)}else N(a.first())},T=function(){r.removeClass("hide"),q.removeClass("hide"),A.addClass("show"),B.addClass("show"),n.data(f,setTimeout(function(){A.addClass("in"),B.addClass("in")},20)),l.removeClass("query-enabled")},U=function(a){if(A){if(p.data("queryString")!==a&&(p.data("queryString",a).val(a),n.css("min-height",n.height())),a===i||null===a||!a.length)return void T();l.addClass("query-enabled");var c=[];if(b.each(a.split(" "),function(a,d){d=b.trim(d).toLowerCase();var f={origin:d};d.startsWith("#")?(f.type="id",f.val=d.substr(1)):d.startsWith("icon-")||d.startsWith("icon:")?(f.type="icon",f.val=d.substr(5)):d.startsWith("i:")?(f.type="icon",f.val=d.substr(1)):d.startsWith("ver:")?(f.type="version",f.val=d.substr(4)):d.startsWith("v:")?(f.type="version",f.val=d.substr(2)):d.startsWith("version:")?(f.type="version",f.val=d.substr(8)):d.startsWith("grunt:")||d.startsWith("build:")?(f.type="build",f.val=d.substr(6)):d.startsWith("g:")||d.startsWith("b:")?(f.type="build",f.val=d.substr(2)):(b.each(e,function(a){return d.startsWith(a+":")?(f.type="id",f.chapter=a,f.val=d.substr(a.length),!1):void 0}),f.type||(f.type="any",f.val=d)),f.val.length&&c.push(f)}),!c.length)return void T();var f,g,h,j,k,o,q,s={},t={};if(H(function(a,d){h=!0,o=[],f=0,b.each(c,function(c,e){switch(k=e.val,q=null,j=!1,e.type){case"id":j=(e.chapter?a:d).id.includes(k),j&&(q=[e.chapter?"chapter":"section","id"]),f=100;break;case"icon":j="icons"===d.id,j&&(q=["section","id"]),f=100;break;default:if(d.name.toLowerCase().includes(k)){j=!0,q=["section","name"],f=80;break}if(a.name.toLowerCase().includes(k)){j=!0,q=["chapter","name"],f=70;break}if(k.length>1){if(d.id.includes(k)){j=!0,q=["section","id"],f=65;break}if(a.id.includes(k)){j=!0,q=["chapter","id"],f=60;break}if(b.isArray(d.topics)){var g=!1;if(b.each(d.topics,function(a,b){return b.name&&b.name.toLowerCase().includes(k)?(j=!0,q=["section","topic",a],g=!0,f=20,!1):void 0}),g)break}if(d.desc.toLowerCase().includes(k)){j=!0,q="section.desc",f=30;break}}else{if(a.id.startsWith(k)){j=!0,q=["chapter","id"],f=60;break}if(d.id.startsWith(k)){j=!0,q=["section","id"],f=50;break}}}return j?void o.push({key:e,type:q}):(h=!1,!1)}),g=a.id+"-"+d.id,h?(t[a.id]++,s[g]={hidden:!1,matches:o,weight:f}):s[g]={hidden:!0}},function(a){t[a.id]=0})){var u,v,w=b(),x=b(),y=-1;b.each(s,function(a,c){u=b("#section-"+a),c.hidden?w=w.add(u):(x=x.add(u),y<c.weight&&(v=u,y=c.weight)),N(v)});var B,C;b.each(t,function(a,b){C=e[a],B=!b,C.$.toggleClass("hide",B)});var D,E=0;r.each(function(){D=b(this);var a=D.children(".chapter:not(.hide)").length;if(D.toggleClass("hide",!a),a&&(E++,!l.hasClass("compact-mode"))){var c=D.find(".section:not(.hide)").length;c>2&&m.height()<z.height()+70*c&&(l.addClass("compact-mode"),setTimeout(function(){m.scrollTop(1),l.addClass("compact-mode-in")},10))}}),n.attr("data-show-col",E),w.length&&(w.removeClass("in"),setTimeout(function(){w.removeClass("show")},100)),x.length&&(x.addClass("show"),setTimeout(function(){x.addClass("in")},20)),m.scrollTop(1),W()}else d&&console.error("Query failed with key: ",c)}},V=function(a,b){a===i&&(a=!l.hasClass("compact-mode"));var c="isScrollAnimating";a?l.hasClass("compact-mode")?b&&b():(l.data(c,!0).addClass("compact-mode"),setTimeout(function(){l.addClass("compact-mode-in"),m.scrollTop(1),setTimeout(function(){l.data(c,!1),b&&b()},500)},10)):l.hasClass("compact-mode")?(l.data(c,!0).removeClass("compact-mode-in"),setTimeout(function(){l.removeClass("compact-mode"),l.data(c,!1),b&&b()},500)):b&&b()},W=function(){if(l.hasClass("page-open")){var a=t.data("trans-style");return a["max-height"]="",t.css(a),l.addClass("page-show-out").removeClass("page-open page-show-in"),setTimeout(function(){l.removeClass("page-show page-show-out"),F()},300),!0}return!1},X=function(b,c,e){var f=c.chapter+"-"+c.id;if(l.hasClass("page-open")&&f===l.attr("data-page"))return void(d&&console.error("The page already showed."));N(b,!1,!0),a.location.hash="#"+f,l.attr("data-page-chapter",c.chapter).attr("data-page",f),I(u.find(".icon"),c),u.find(".name").text(c.name).attr("href","#"+c.chapter+"-"+c.id),u.children(".desc").text(c.desc),v.html("");var g=t.addClass("loading").find(".loader").addClass("loading");return G(c.url,function(a){t.removeClass("loading"),g.removeClass("loading"),v.html(a),p.blur(),x.scrollTop(0)}),l.hasClass("page-open")?void(d&&console.log("open section in open page",c)):(l.addClass("page-open"),void V(!0,function(){var a=b.offset(),c=b.outerHeight(),d={left:a.left-n.children(".container").offset().left-6,top:a.top-m.scrollTop()-81,width:b.outerWidth(),height:c,"max-height":c};E(),l.addClass("page-show"),t.css(d).data("trans-style",d),x.css("width",D),setTimeout(function(){l.addClass("page-show-in"),t.hasClass("loading")&&t.addClass("openning").css("height",380),x.scrollTop(0),setTimeout(function(){t.removeClass("openning"),D=x.css("width","").width()+40,Z()},310)},10)}))},Y=function(c,e){c=c||s;var f;if(b.isArray(c)){var g=k[h];if(!(g&&c.length>1))return void(d&&console.error("Open section stop by null docIndex or wrong section value."));var i=c[1],j=g.chapters[c[0]].sections,l=!1;for(var m in j){var n=j[m];if(n.id===i){c.length>2&&(e=c[2]),c=n,l=!0;break}}if(!l)return void console.error("Open section failed: can't find the section with id "+c.join("-"))}if(b.isPlainObject(c))f=b("#section-"+c.chapter+"-"+c.id);else{var o=c;c=o.data("section"),f=o}var p=c.url;return null===p?void(d&&console.error("Open section stop by null url.")):(p||(p="part/"+c.chapter+"-"+c.id+".html",c.url=p),p=p.toLowerCase(),void(p.startsWith("http://")||p.startsWith("https://")?a.open(p,"_blank"):X(f,c,e)))};a.openS=Y;var Z=function(){if(!l.hasClass("page-show-out")&&!t.hasClass("loading")){var a;l.hasClass(j)?(a=m.height(),x.toggleClass("with-scrollbar",v.outerHeight()>a-40-u.outerHeight())):a=Math.min(w.outerHeight(),u.outerHeight()+v.outerHeight()+50),t.css("height",a)}};b(function(){var c=function(a){a.stopPropagation()};m=b(a),l=b("body"),y=b("#navbar"),n=b("#grid"),z=b("#header"),r=n.find(".col"),t=b("#page"),u=b("#pageHeader"),w=b("#pageContainer"),v=b("#pageContent"),q=n.find(".chapter"),p=b("#searchInput"),B=n.find(".chapter-heading"),o=b("#sectionTemplate").attr("id",null),x=b("#pageBody"),b.each(e,function(a,c){a=a.toLowerCase(),c.$=b("#chapter-"+a),c.id=a,c.$sections=b("#sections-"+a)}),D=n.children(".container").outerWidth(),l.toggleClass(j,b.store.get(j,!1)),G(h,function(b){J(b);var c=a.location.hash;c?(c=c.substr(1),setTimeout(function(){Y(c.split("-"))},300)):p.focus()}),b(document).on("click",function(a){return l.hasClass("page-show")?void W():(N(),void A.removeClass("open"))}),t.on("click",c),n.on("click",".card-heading",function(a){var d=b(this).closest(".card");d.hasClass("choosed")?d.toggleClass("open"):N(d,!0),c(a)}).on("click",".card",function(a){N(b(this),!0),c(a)}).on("click",".card-heading > h5 > .name, .card-heading > .icon",function(a){Y(b(this).closest(".section")),c(a)}).on("click",".topics > li",function(a){var d=b(this);Y(d.closest(".section"),d.data("id")),c(a)}).on("mouseenter",".card-heading > h5 > .name, .card-heading > .icon",function(){b(this).closest(".card-heading").addClass("hover")}).on("mouseleave",".card-heading > h5 > .name, .card-heading > .icon",function(){b(this).closest(".card-heading").removeClass("hover")}),v.on("resize",Z),m.resize(Z),u.on("click",".path-close-btn",function(){W()}).on("click",".path-max-btn",function(){l.toggleClass(j),setTimeout(Z,300),b.store.set(j,l.hasClass(j))});var d,f=b("#navbar").outerHeight();m.on("scroll",function(a){var b=l.data("isScrollAnimating");return b?void m.scrollTop(1):(d=m.scrollTop(),void(d>f&&!l.hasClass("compact-mode")?V(!0):l.hasClass("compact-mode")&&(1>d?V(!1):z.toggleClass("with-shadow",d>20))))}).on("keydown",function(a){var b=a.which,c=!l.hasClass("page-show");13===b?c&&M()&&Y():27===b?W()||l.hasClass("input-query-focus")&&U():32===b?(W()||(l.hasClass("compact-mode")?M()&&Y():V(!0)),a.preventDefault()):37===b?(R(),a.preventDefault()):39===b?(S(),a.preventDefault()):38===b?c?(O(),a.preventDefault()):K(x,"up"):40===b&&(c?(P(),a.preventDefault()):K(x),a.preventDefault())}),x.on("scroll",function(a){t.toggleClass("with-shadow",x.scrollTop()>20)}),p.on("change keyup paste input propertychange",function(){var a=p.val();a!==p.data("queryString")&&(clearTimeout(p.data(g)),p.data(g,setTimeout(function(){U(a)},150)))}).on("focus",function(){l.addClass("input-query-focus"),p.val()&&!A.filter(".open").length&&N(A.filter(".show:first"))}).on("blur",function(){l.removeClass("input-query-focus")}).on("click",c),b('[data-toggle="tooltip"]').tooltip({container:"body"})})}(window,jQuery);