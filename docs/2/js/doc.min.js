/*!
 * ZUI - v1.2.1 - 2015-04-16
 * http://zui.sexy
 * GitHub: https://github.com/easysoft/zui.git 
 * Copyright (c) 2015 cnezsoft.com; Licensed MIT
 */

!function(a,b){"use strict";String.prototype.endsWith||(String.prototype.endsWith=function(a,b){var c=this.toString();(void 0===b||b>c.length)&&(b=c.length),b-=a.length;var d=c.indexOf(a,b);return-1!==d&&d===b}),String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return b=b||0,this.lastIndexOf(a,b)===b}),String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)});var c=!1,d=1;d&&console.error("DEBUG ENABLED.");var e={learn:{col:1},start:{col:1},basic:{col:1},control:{col:2},component:{col:2},javascript:{col:3},view:{col:3}},f="lastReloadAnimate",g="LAST_QUERY_ID",h="index.json",i=void 0,j={"index.json":null};d&&(a.dataset=j);var k,l,m,n,o,p,q,r,s,t,u,v,w,x=-1,y=function(){if(!(document.body.clientWidth>=a.innerWidth)){if(0>x){var b=document.createElement("div");b.className="modal-scrollbar-measure",k.append(b),x=b.offsetWidth-b.clientWidth,k[0].removeChild(b)}if(x){var c=parseInt(k.css("padding-right")||0,10);k.css("padding-right",c+x)}}},z=function(){k.css("padding-right","")},A=function(a,e,f){var g=j[a],h=null===g;if(h&&(g=b.store.get(a,null),j[a]=g,null!==g&&(d&&console.log("Load data from storage: ",a,"=",g),e(g))),null===g||f||h||!c){var i=a.endsWith(".json")?"json":"html";b.get(a,function(c){if(!d&&null!==g){if("json"===i&&b.isPlainObject(c)&&g.version&&c.version&&c.version===g.version)return;if("html"===i&&g===c)return}j[a]=c,d&&console.log("Load data from remote: ",a,"=",c),e(c),b.store.set(a,c)},i)}},B=function(a,c){var d=j[h];return d?(b.each(e,function(e,f){if(d.chapters[e]){b.extend(f,d.chapters[e]);var g=f.sections,h=null;return c&&(h=c(f,g),h===!1)?!1:void b.each(g,function(b,c){return a(f,c,h)===!1?!1:void 0})}}),!0):(console.error("Document index is empty."),!1)},C=function(a,b){a.attr("class","icon").text(""),(void 0===b.icon||null===b.icon||""===b.icon)&&(b.icon=b.name.substr(0,1).toUpperCase()),0===b.icon.indexOf("icon-")?a.addClass(b.icon):a.addClass("text-icon").text(b.icon)},D=function(){B(function(a,b,c){var d=a.id;b.chapter=d;var e=n.clone().attr("id","section-"+d+"-"+b.id).data("section",b);e.attr("data-id",b.id).attr("data-chapter",d);var f=e.children(".card-heading");f.find(".name").text(b.name),f.children(".desc").text(b.desc),C(f.children(".icon"),b);var g=e.find(".topics");if(b.topics&&b.topics.length)for(var h in b.topics){var i=b.topics[h];i.id=h,g.append('<li data-id="'+h+'">'+i.name+"</li>")}else g.remove(".card-content"),e.addClass("without-topics");c.append(e.addClass("show"))},function(a,b){var c=a.$sections;return c.children().remove(),c})?(clearTimeout(m.data(f)),m.data(f,setTimeout(function(){v=m.find(".section").addClass("in"),w.addClass("in")},100))):d&&console.error("Display sections failed.")},E=function(a,b,c){if(v){if(a&&a.hasClass("choosed")&&!c)return void a.addClass("open");var d=a&&a.hasClass("open");v.removeClass(b?"choosed":"choosed open"),a&&a.hasClass("section")&&(r=a.addClass(c&&!d?"choosed":"choosed open"))}},F=function(){q.removeClass("hide"),p.removeClass("hide"),v.addClass("show"),w.addClass("show"),m.data(f,setTimeout(function(){v.addClass("in"),w.addClass("in")},20)),k.removeClass("query-enabled")},G=function(a){if(v){if(o.data("queryString")!==a&&(o.data("queryString",a).val(a),m.css("min-height",m.height())),a===i||null===a||!a.length)return void F();k.addClass("query-enabled");var c=[];if(b.each(a.split(" "),function(a,d){d=b.trim(d).toLowerCase();var f={origin:d};d.startsWith("#")?(f.type="id",f.val=d.substr(1)):d.startsWith("icon-")||d.startsWith("icon:")?(f.type="icon",f.val=d.substr(5)):d.startsWith("i:")?(f.type="icon",f.val=d.substr(1)):d.startsWith("ver:")?(f.type="version",f.val=d.substr(4)):d.startsWith("v:")?(f.type="version",f.val=d.substr(2)):d.startsWith("version:")?(f.type="version",f.val=d.substr(8)):d.startsWith("grunt:")||d.startsWith("build:")?(f.type="build",f.val=d.substr(6)):d.startsWith("g:")||d.startsWith("b:")?(f.type="build",f.val=d.substr(2)):(b.each(e,function(a){return d.startsWith(a+":")?(f.type="id",f.chapter=a,f.val=d.substr(a.length),!1):void 0}),f.type||(f.type="any",f.val=d)),f.val.length&&c.push(f)}),!c.length)return void F();var f,g,h,j,n,p,r,s={},t={};if(B(function(a,d){h=!0,p=[],f=0,b.each(c,function(c,e){switch(n=e.val,r=null,j=!1,e.type){case"id":j=(e.chapter?a:d).id.includes(n),j&&(r=[e.chapter?"chapter":"section","id"]),f=100;break;case"icon":j="icons"===d.id,j&&(r=["section","id"]),f=100;break;default:if(d.name.toLowerCase().includes(n)){j=!0,r=["section","name"],f=80;break}if(a.name.toLowerCase().includes(n)){j=!0,r=["chapter","name"],f=70;break}if(n.length>1){if(d.id.includes(n)){j=!0,r=["section","id"],f=65;break}if(a.id.includes(n)){j=!0,r=["chapter","id"],f=60;break}if(b.isArray(d.topics)){var g=!1;if(b.each(d.topics,function(a,b){return b.name&&b.name.toLowerCase().includes(n)?(j=!0,r=["section","topic",a],g=!0,f=20,!1):void 0}),g)break}if(d.desc.toLowerCase().includes(n)){j=!0,r="section.desc",f=30;break}}else{if(a.id.startsWith(n)){j=!0,r=["chapter","id"],f=60;break}if(d.id.startsWith(n)){j=!0,r=["section","id"],f=50;break}}}return j?void p.push({key:e,type:r}):(h=!1,!1)}),g=a.id+"-"+d.id,h?(t[a.id]++,s[g]={hidden:!1,matches:p,weight:f}):s[g]={hidden:!0}},function(a){t[a.id]=0})){var w,x,y=b(),z=b(),A=-1;b.each(s,function(a,c){w=b("#section-"+a),c.hidden?y=y.add(w):(z=z.add(w),A<c.weight&&(x=w,A=c.weight)),E(x)});var C,D;b.each(t,function(a,b){D=e[a],C=!b,D.$.toggleClass("hide",C)});var G,H=0;q.each(function(){G=b(this);var a=G.children(".chapter:not(.hide)").length;if(G.toggleClass("hide",!a),a&&(H++,!k.hasClass("compact-mode"))){var c=G.find(".section:not(.hide)").length;c>2&&l.height()<u.height()+70*c&&(k.addClass("compact-mode"),setTimeout(function(){l.scrollTop(1),k.addClass("compact-mode-in")},10))}}),m.attr("data-show-col",H),y.length&&(y.removeClass("in"),setTimeout(function(){y.removeClass("show")},100)),z.length&&(z.addClass("show"),setTimeout(function(){z.addClass("in")},20)),l.scrollTop(1),k.removeClass("page-show page-show-in")}else d&&console.error("Query failed with key: ",c)}},H=function(a,b){var c="isScrollAnimating";a?k.hasClass("compact-mode")?b&&b():(k.data(c,!0).addClass("compact-mode"),setTimeout(function(){k.addClass("compact-mode-in"),l.scrollTop(1),setTimeout(function(){k.data(c,!1),b&&b()},500)},10)):k.hasClass("compact-mode")?(k.data(c,!0).removeClass("compact-mode-in"),setTimeout(function(){k.removeClass("compact-mode"),k.data(c,!1),b&&b()},500)):b&&b()},I=function(){k.hasClass("page-show")&&(k.removeClass("page-show-in"),setTimeout(function(){k.removeClass("page-show"),z()},150))},J=function(a,c){console.log("Open page: ",a,c,d);var d;if(b.isPlainObject(a))d=b("#section-"+a.chapter+"-"+a.id);else{var e=a;a=e.data("section"),d=e}console.log(a,d),E(d,!1,!0),I(),k.attr("data-page-chapter",a.chapter),C(t.children(".icon"),a),t.find(".name").text(a.name),t.children(".desc").text(a.desc),H(!0,function(){var a=d.offset();s.css({left:a.left-m.children(".container").offset().left-15,top:a.top-l.scrollTop()-80,width:d.outerWidth(),height:d.outerHeight()}),y(),k.addClass("page-show"),setTimeout(function(){k.addClass("page-show-in")},10)})};b(function(){var c=function(a){a.stopPropagation()};l=b(a),k=b("body"),m=b("#grid"),u=b("#header"),q=m.find(".col"),s=b("#page"),t=b("#pageHeader"),p=m.find(".chapter"),o=b("#searchInput"),w=m.find(".chapter-heading"),n=b("#sectionTemplate").attr("id",null),b.each(e,function(a,c){a=a.toLowerCase(),c.$=b("#chapter-"+a),c.id=a,c.$sections=b("#sections-"+a)}),A(h,D),b(document).on("click",function(a){return k.hasClass("page-show")?void I():(E(),void v.removeClass("open"))}),s.on("click",c),m.on("click",".card-heading",function(a){var d=b(this).closest(".card");d.hasClass("choosed")?d.toggleClass("open"):E(d,!0),c(a)}).on("click",".card",function(a){E(b(this),!0),c(a)}).on("click",".card-heading > h5 > .name, .card-heading > .icon",function(a){J(b(this).closest(".section")),c(a)}).on("click",".topics > li",function(a){var d=b(this);J(d.closest(".section"),null,d.data("id")),c(a)}).on("mouseenter",".card-heading > h5 > .name, .card-heading > .icon",function(){b(this).closest(".card-heading").addClass("hover")}).on("mouseleave",".card-heading > h5 > .name, .card-heading > .icon",function(){b(this).closest(".card-heading").removeClass("hover")}),t.on("click",".path-close-btn",function(){I()});var d,f=b("#navbar").outerHeight();l.on("scroll",function(a){var b=k.data("isScrollAnimating");return b?void l.scrollTop(1):(d=l.scrollTop(),void(d>f&&!k.hasClass("compact-mode")?H(!0):k.hasClass("compact-mode")&&(1>d?H(!1):u.toggleClass("with-shadow",d>20))))}),o.on("change keyup paste input propertychange",function(){var a=o.val();a!==o.data("queryString")&&(clearTimeout(o.data(g)),o.data(g,setTimeout(function(){G(a)},150)))}).on("focus",function(){k.addClass("input-query-focus"),o.val()&&!v.filter(".open").length&&E(v.filter(".show:first"))}).on("blur",function(){k.removeClass("input-query-focus")}).on("click",c),b('[data-toggle="tooltip"]').tooltip({container:"body"})})}(window,jQuery);